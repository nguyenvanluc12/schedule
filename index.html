<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Pomodoro Timer</title>
  <style>
    body {
      background-image: url('https://scontent.fvii1-1.fna.fbcdn.net/v/t39.30808-6/520262592_122140360688771341_7341266968348833978_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=127cfc&_nc_eui2=AeF4NKsHEvQr3kGxZQs-bHlC4N8lGFYLo8ng3yUYVgujyaWMcl9aDewFEHebcocvj3xXsgiyRFnSjnFvVyYKQ9Xy&_nc_ohc=qgHOqcJjlCUQ7kNvwHv9Kfr&_nc_oc=AdlasptwgZrFDUuvrEoSgtDgQnLaAkOWdN1AdEfs5S6tpdPV6f4iXfSK6BZSEDJYimU&_nc_zt=23&_nc_ht=scontent.fvii1-1.fna&_nc_gid=1bhrAWtf_WqTmDpRxeH47A&oh=00_AfTU9IDz1-yZYvNdbBWop7DT1ujH-V8gCtbksWoMnTTPtw&oe=6888E8CF');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 16px;
      color: #fff;
      margin: 0;
    }

    h1 {
      font-size: 20px;
      margin: 10px 0;
    }

    #timer {
      font-size: 40px;
      margin: 20px 0;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      background-color: #2E4C3A;
      color: white;
      cursor: pointer;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
      pointer-events: none;
    }

    #music-notice {
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px;
      border-radius: 8px;
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
      display: none;
    }

    iframe {
      position: fixed;
      right: 20px;
      bottom: 20px;
      width: 300px;
      height: 200px;
      border: none;
      z-index: 1;
    }
  </style>
</head>
<body>
  <h1>Pomodoro Timer</h1>
  <div id="timer">25:00</div>
  <button onclick="startTimer()">Bắt đầu</button>
  <button onclick="resetTimer()">Đặt lại</button>

  <div id="music-notice">Nhấn vào màn hình để bật nhạc</div>
  <canvas id="fireworks"></canvas>
  <iframe id="youtube-player" src="https://www.youtube.com/embed/hHW1oY26kxQ?enablejsapi=1&autoplay=0" allow="autoplay"></iframe>

  <script>
    let timerDisplay = document.getElementById('timer');
    let musicNotice = document.getElementById('music-notice');
    let youtubePlayer = document.getElementById('youtube-player');
    let mainContainer = document.body;

    let duration = 25 * 60;
    let timer;
    let isRunning = false;

    function updateDisplay(seconds) {
      let min = Math.floor(seconds / 60);
      let sec = seconds % 60;
      timerDisplay.textContent = `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
    }

    function startTimer() {
      if (isRunning) return;
      isRunning = true;
      timer = setInterval(() => {
        if (duration > 0) {
          duration--;
          updateDisplay(duration);
        } else {
          clearInterval(timer);
          isRunning = false;
        }
      }, 1000);
    }

    function resetTimer() {
      clearInterval(timer);
      duration = 25 * 60;
      updateDisplay(duration);
      isRunning = false;
    }

    // Nhạc và thông báo
    function startMusic() {
      youtubePlayer.src += "&autoplay=1";
      mainContainer.removeEventListener('click', startMusic);
      mainContainer.removeEventListener('touchstart', startMusic);
      musicNotice.style.display = "block";
      setTimeout(() => {musicNotice.style.display = "none";
      }, 1000);
    }

    mainContainer.addEventListener('click', startMusic);
    mainContainer.addEventListener('touchstart', startMusic);

    // Pháo hoa
    const canvas = document.getElementById('fireworks');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    class Particle {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.velocity = {
          x: (Math.random() - 0.5) * 8,
          y: (Math.random() - 0.5) * 8
        };
        this.alpha = 1;
        this.decay = Math.random() * 0.015 + 0.01;
        this.size = Math.random() * 3 + 2;
      }

      draw() {
        ctx.globalAlpha = this.alpha;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }

      update() {
        this.velocity.y += 0.05;
        this.x += this.velocity.x;
        this.y += this.velocity.y;
        this.alpha -= this.decay;
        this.draw();
        return this.alpha > 0;
      }
    }

    let particles = [];

    function createFirework(x, y) {
      const colors = [
        '#ff0000', '#ffff00', '#00ff00',
        '#00ffff', '#0000ff', '#ff00ff',
        '#ff9900', '#ff0099', '#9900ff'
      ];

      const particleCount = 150;

      for (let i = 0; i < particleCount; i++) {
        const color = colors[Math.floor(Math.random() * colors.length)];
        particles.push(new Particle(x, y, color));
      }
    }

    function animate() {
      ctx.fillStyle = 'rgba(10, 10, 20, 0.2)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      particles = particles.filter(p => p.update());

      if (Math.random() < 0.03 && particles.length < 1000) {
        createFirework(Math.random() * canvas.width, Math.random() * canvas.height * 0.5);
      }

      requestAnimationFrame(animate);
    }

    youtubePlayer.onload = function () {
      for (let i = 0; i < 3; i++) {
        setTimeout(() => {
          createFirework(Math.random() * canvas.width, Math.random() * canvas.height * 0.5);
        }, i * 300);
      }
    };

    animate();

    window.addEventListener("resize", () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      youtubePlayer.style.right = "20px";
      youtubePlayer.style.bottom = "20px";
    });
  </script>
</body>
</html>
